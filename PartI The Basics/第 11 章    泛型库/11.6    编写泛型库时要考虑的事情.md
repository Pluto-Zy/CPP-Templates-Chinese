### 11.6    编写泛型库时要考虑的事情

我们来列举一些在实现泛型库时要记住的事情（注意其中的一些可能会在本书的后面介绍）：

+ 使用转发引用在模板中转发值（见原书 91 页 6.1 节）。如果该值不依赖于模板形参，就使用 `auto&&`（见原书 167 页 11.3 节）。
+ 当形参被声明为转发引用时，要预备着在传递左值时模板形参会具有引用类型（见原书 279 页 15.6.2 节）。
+ 当你需要一个依赖于模板形参的对象的地址时，使用 `std::addressof()` 以避免当该对象绑定于具有重载的 `operator&` 的类型时产生令人惊讶的结果。
+ 对于成员函数模板，确保它们不会比预定义的复制/移动构造函数或赋值运算符具有更优的匹配（见原书 99 页 6.4 节）。
+ 当模板参数可以是字符串字面值且没有按值传递时，考虑使用 `std::decay`（见原书 116 页 7.4 节和 731 页 D.4 节）。
+ 如果 out 或 inout 形参依赖于模板形参，要处理可能出现的指定 `const` 模板实参的情况（示例见原书 110 页 7.2.2 节）。
+ 要准备处理模板形参是引用时的副作用（细节见原书 167 页 11.4 节，示例见原书 432 页 19.6.1 节）。特别是，你可能希望确保返回类型不能成为引用（见原书 117 页 7.5 节）。
+ 要准备处理不完整类型，例如，用于支持递归的数据结构（见原书 171 页 11.5 节）。
+ 为所有数组类型提供重载，而不仅仅是 `T[SZ]`（见原书 71 页 5.4 节）。